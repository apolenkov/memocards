# =============================================================================
# MEMOCARDS - Production Environment Variables
# Generated by Ansible
# =============================================================================

# =============================================================================
# DOCKER COMPOSE CONFIGURATION
# =============================================================================
# Container names (prod suffix)
POSTGRES_CONTAINER_NAME=memocards-postgres-prod
APP_CONTAINER_NAME=memocards-app-prod

# Network configuration
NETWORK_NAME=memocards-network
NETWORK_SUBNET=172.20.0.0/16

# Ports (numbers only - IP binding in docker-compose.yml)
POSTGRES_PORT=5432
APP_PORT=8080
{% if prometheus_enabled %}
PROMETHEUS_PORT=9090
{% endif %}
{% if loki_enabled %}
LOKI_PORT=3100
{% endif %}
{% if promtail_enabled %}
PROMTAIL_ENABLED=true
{% endif %}
{% if grafana_enabled %}
GRAFANA_PORT={{ grafana_port }}
GRAFANA_ADMIN_USER={{ grafana_admin_user }}
GRAFANA_ADMIN_PASSWORD={{ vault_grafana_admin_password }}
GRAFANA_ENABLED=true
GRAFANA_URL=http://localhost:3000
GRAFANA_ROOT_URL=https://{{ domain }}/grafana/
{% endif %}

# Logs path
APP_LOGS_PATH=/opt/memocards/logs

# Monitoring containers (prod suffix)
PROMETHEUS_CONTAINER_NAME={{ prometheus_container_name }}
GRAFANA_CONTAINER_NAME={{ grafana_container_name }}
LOKI_CONTAINER_NAME={{ loki_container_name }}
PROMTAIL_CONTAINER_NAME={{ promtail_container_name }}

# =============================================================================
# APPLICATION IMAGE
# =============================================================================
APP_IMAGE={{ app_image }}

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
DB_URL=jdbc:postgresql://postgres:5432/{{ db_name }}
DB_NAME={{ db_name }}
DB_USER={{ db_user }}
DB_PASSWORD={{ vault_db_password }}
POSTGRES_INITDB_ARGS=--auth-host=scram-sha-256

# =============================================================================
# RESOURCE LIMITS (Production)
# =============================================================================
POSTGRES_MEMORY_LIMIT=512m
POSTGRES_MEMORY_RESERVATION=256m
APP_MEMORY_LIMIT=1500m
APP_MEMORY_RESERVATION=512m

# =============================================================================
# HEALTHCHECK CONFIGURATION
# =============================================================================
POSTGRES_HEALTHCHECK_START=30s
APP_HEALTHCHECK_START=60s

# =============================================================================
# CACHE CONFIGURATION (Production)
# =============================================================================
CACHE_USER_TTL=30
CACHE_USER_MAX_SIZE=1000
CACHE_DECKS_TTL=300000
CACHE_DECKS_MAX_SIZE=1000
CACHE_KNOWN_CARDS_TTL=600000
CACHE_KNOWN_CARDS_MAX_SIZE=1000
CACHE_PAGINATION_COUNT_TTL=300000
CACHE_PAGINATION_COUNT_MAX_SIZE=500

# Cache Monitoring
CACHE_MONITORING_ENABLED=true
CACHE_LOG_INTERVAL=300000

# =============================================================================
# UI CONFIGURATION
# =============================================================================
SEARCH_DEBOUNCE_MS=300
PAGINATION_PAGE_SIZE=50

# =============================================================================
# MONITORING & PERFORMANCE
# =============================================================================
SLOW_QUERY_THRESHOLD=100
HIKARI_MONITORING_ENABLED=true
HIKARI_LOG_INTERVAL=60000

# =============================================================================
# SECURITY
# =============================================================================
MAX_FAILED_ATTEMPTS=5
FAILED_ATTEMPTS_WINDOW=15

# =============================================================================
# MANAGEMENT & ACTUATOR
# =============================================================================
MANAGEMENT_ENDPOINTS=health,info,metrics,prometheus
MANAGEMENT_HEALTH_SHOW_DETAILS=when-authorized
MANAGEMENT_HEALTH_SHOW_COMPONENTS=when-authorized
MANAGEMENT_METRICS_JVM=true
MANAGEMENT_METRICS_JDBC=true
MANAGEMENT_METRICS_HIKARI=true
MANAGEMENT_METRICS_LOGBACK=true
MANAGEMENT_PROMETHEUS_ENABLED=true

# =============================================================================
# VAADIN CONFIGURATION
# =============================================================================
VAADIN_LAUNCH_BROWSER=false
VAADIN_PRODUCTION_MODE=true

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================
SERVER_PORT=8080
SERVER_COMPRESSION_ENABLED=true
SERVER_COMPRESSION_MIN_SIZE=512
SERVER_HTTP2_ENABLED=true

# =============================================================================
# SPRING CONFIGURATION
# =============================================================================
SPRING_PROFILES_ACTIVE=prod

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
# Logging path (mapped to host /opt/memocards/logs)
LOGGING_FILE_PATH=/app/logs
LOGGING_FILE_NAME=application.log

# =============================================================================
# JVM CONFIGURATION
# =============================================================================
# NOTE: JVM flags are configured in build.gradle.kts (Jib container.jvmFlags)
# DO NOT set JAVA_OPTS here - it will override Jib's optimized settings!
# Current Jib settings: MaxRAMPercentage=75.0, UseG1GC, UseContainerSupport

# =============================================================================
# DATA SEEDING (Production)
# =============================================================================
SEED_DEMO_DATA=true
DEMO_ADMIN_PASSWORD={{ vault_demo_admin_password }}
DEMO_USER_PASSWORD={{ vault_demo_user_password }}

# =============================================================================
# TEST DATA GENERATION (Disabled in production)
# =============================================================================
GENERATE_TEST_DATA=false
TEST_USER_PASSWORD={{ vault_test_user_password }}
BATCH_SIZE_USERS=100
LIMIT_USERS=100
LIMIT_DECKS=10
LIMIT_CARDS=50
LIMIT_NEWS=50